<view><block wx:if="{{!isLoggedIn}}"><view class="login-container"><view class="login-box"><text class="login-title">登录</text><input class="login-input" placeholder="请输入账号" confirm-type="done" data-event-opts="{{[['confirm',[['checkLogin',['$event']]]],['input',[['__set_model',['','loginAccount','$event',[]]]]]]}}" value="{{loginAccount}}" bindconfirm="__e" bindinput="__e"/><input class="login-input" placeholder="请输入密码" type="password" confirm-type="done" data-event-opts="{{[['confirm',[['checkLogin',['$event']]]],['input',[['__set_model',['','loginPassword','$event',[]]]]]]}}" value="{{loginPassword}}" bindconfirm="__e" bindinput="__e"/><button data-event-opts="{{[['tap',[['checkLogin',['$event']]]]]}}" class="login-button" bindtap="__e">登录</button></view></view></block><block wx:else><view class="main-container"><view class="container"><view class="header"><text class="title">设备检测</text></view><view class="device-section"><view class="device-input-group"><input class="device-input" type="text" placeholder="请输入或扫码获取设备编号" data-event-opts="{{[['input',[['__set_model',['','deviceId','$event',[]]]]]]}}" value="{{deviceId}}" bindinput="__e"/><button class="scan-btn" type="primary" data-event-opts="{{[['tap',[['scanCode',['$event']]]]]}}" bindtap="__e">扫码</button></view></view><view class="process-section"><text class="label">选择工序</text><picker class="process-picker" mode="selector" range="{{processNames}}" value="{{currentProcessIndex}}" data-event-opts="{{[['change',[['handleProcessChange',['$event']]]]]}}" bindchange="__e"><view class="picker-text">{{''+(processNames[currentProcessIndex]||'请选择工序')+''}}</view></picker></view><block wx:if="{{currentProcessIndex!==null}}"><view class="form-section"><form data-event-opts="{{[['submit',[['handleSubmit',['$event']]]]]}}" bindsubmit="__e"><view class="form-item"><text class="label">检测人员</text><input class="input-text" type="text" placeholder="请输入检测人员" data-event-opts="{{[['input',[['__set_model',['$0','inspector','$event',[]],['currentProcess']]]]]}}" value="{{currentProcess.inspector}}" bindinput="__e"/></view><view class="form-item"><text class="label">检测时间</text><picker mode="date" value="{{currentProcess.inspectTime}}" data-event-opts="{{[['change',[['handleDateChange',['$event']]]]]}}" bindchange="__e"><view class="picker-text">{{''+(currentProcess.inspectTime||'请选择检测时间')+''}}</view></picker></view><view class="form-item"><text class="label">检验结果</text><picker mode="selector" range="{{inspectResultOptions}}" value="{{$root.g0}}" data-event-opts="{{[['change',[['handleInspectResultChange',['$event']]]]]}}" bindchange="__e"><view class="picker-text">{{''+(currentProcess.inspectResult||'请选择检验结果')+''}}</view></picker></view><view class="form-item"><text class="label">检测图片</text><view class="image-upload"><block wx:if="{{currentProcess.image}}"><image class="preview-image" src="{{currentProcess.image}}" mode="aspectFit"></image></block><button data-event-opts="{{[['tap',[['handleUploadImage',['$event']]]]]}}" class="upload-btn" bindtap="__e">{{''+(currentProcess.image?'重新上传':'上传图片')+''}}</button></view></view><button class="submit-btn" form-type="submit" type="primary" disabled="{{!deviceId}}">提交表单</button></form></view></block><view class="export-section"><button data-event-opts="{{[['tap',[['handleExport',['$event']]]]]}}" class="export-btn" bindtap="__e">导出全部数据</button><button data-event-opts="{{[['tap',[['handleCancelExport',['$event']]]]]}}" class="cancel-export-btn" bindtap="__e">终止导出</button></view></view></view></block></view>